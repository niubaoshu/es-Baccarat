# EZ Baccarat 模拟器 (Go)

*阅读其他语言版本: [English](README.md), [简体中文](README_zh.md)*

由 Go 语言编写的蒙特卡洛引擎以及交互式命令行 **免佣百家乐 (EZ Baccarat)** 游戏。

本项目从数学层面严格实现了免佣百家乐的补牌发牌规则，涵盖了官方赔率以及广受欢迎的 **Dragon 7（龙七）** 和 **Panda 8（熊猫八）** 附加注的统计学概率。

## 核心功能 (Features)
* **绝对精准的数学引擎**: 严格遵循 [加州赌博控制局 (BGC)](https://oag.ca.gov/sites/all/files/agweb/pdfs/gambling/BGC_ez_baccarat_panda_8.pdf) 批准的第三张牌抽取矩阵和天生赢家 (Natural 8/9) 锁定法则。
* **高并发蒙特卡洛仿真**: 利用 Go 协程（Goroutines）和通道（Channels）机制，实现了每秒数百万手的模拟速度。其多线程并发输出的精确赌场优势（House Edge）和开出概率完美匹配了百家乐的学术极限理论值。
* **交互式命令行对局**: 直接在终端机里原生地游玩标准百家乐。
* **完整支持附加注系统**: 全面复现了 EZ Baccarat 独有的“龙七”(1赔40) 和“熊猫8”(1赔25) 特殊下注逻辑。
* **玩家状态与数据持久化**: 系统会自动在本地保存各玩家虚拟游戏账户的余额与流水日志。

## EZ Baccarat (免水百家乐) 规则概要

与经典的传统百家乐不同，免水百家乐取消了庄家赢钱时的 5% 抽水（佣金），并用一种特定的赢局情况作为补偿条件。

### 基础赔付
* **闲赢 (Player Win)**: 1 赔 1。
* **庄赢 (Banker Win)**: 1 赔 1（无抽水 / 免佣）。
* **和局 (Tie)**: 1 赔 8。

### 特殊附加条款与边注 (Side Bets)
1. **Dragon 7 (龙七)**:
   * 触发条件：当庄家以**恰好 3 张牌**且总点数为 **7 点**时赢得该局。
   * 如果玩家押了**庄家 (Banker)**，该注单算作**平局退回 (Push)**（返还本金，不输不赢）。赌场正是用这个规则取代了 5% 的抽水机制。
   * 如果玩家单独押了侧注 **Dragon 7**，则赔付 **40 赔 1**。

2. **Panda 8 (熊猫8)**: 
   * 触发条件：当闲家以**恰好 3 张牌**且总点数为 **8 点**时赢得该局。
   * 如果玩家押了**闲家 (Player)**，由于这是普通的闲赢，正常赔付 1 赔 1。
   * 如果玩家单独押了侧注 **Panda 8**，则赔付 **25 赔 1**。

### 补牌规则 (Drawing Rules)
发第三张牌的矩阵完全取决于闲家的总点数和庄家的总点数。其中最重要的顶层规则是：**如果闲家或庄家在起手的前两张牌中获得了 8 点或 9 点，被称为“天生赢家 (Natural)”，该局立刻结束。** 双方均不允许再要第三张牌，直接开牌比大小。

## 模拟结果参考

以下是执行一亿局 (100,000,000 rounds) 蒙特卡洛模拟的输出示例：

```text
Starting simulation of 100000000 rounds using 30 workers...

=== Simulation Complete ===
Total Rounds: 100000000
Time Taken:   20.634266008s (4846308 rounds/sec)

Outcome              | Count        | Simulated %  | Expected %  
------------------------------------------------------------------
Player (Total)       |     44623956 |     44.6240% |     44.6247%
  ↳ Panda 8          |      3454935 |      3.4549% |      3.4543%
Banker (Non-Dragon)  |     43609570 |     43.6096% |     43.6064%
Tie                  |      9513636 |      9.5136% |      9.5156%
Dragon 7             |      2252838 |      2.2528% |      2.2534%
------------------------------------------------------------------
Total                |    100000000 |    100.0000% |    100.0000%
==================================================================

Bet Type ($1/hand)   | Net Profit ($)   | Simulated EV    | Expected EV    
-----------------------------------------------------------------------
Banker               |         -1014386 |        -1.0144% |        -1.0183%
Player               |         -1238452 |        -1.2385% |        -1.2351%
Tie                  |        -14377276 |       -14.3773% |       -14.3596%
Dragon 7             |         -7633642 |        -7.6336% |        -7.6106%
Panda 8              |        -10171690 |       -10.1717% |       -10.1882%
=======================================================================
```

*(详尽的组合穷举、各类赌注的 EV 计算公式细节均记载于 `ez_baccarat_requirements.md` 需求文档中)*

## 运行与使用方法 (Usage)

### 1. 编译构建
```bash
go build -o ez_baccarat .
```

### 2. 交互式游玩模式
启动互动终端，您可以使用虚拟筹码亲身模拟玩家体验：
```bash
# 以默认访客身份开始游戏
./ez_baccarat

# 创建一个带有初始本金的新玩家账户
./ez_baccarat --create_player --player="Alice" --initial_balance=10000

# 以已有的账户信息继续游戏
./ez_baccarat --player="Alice"
```

### 3. 高并发模拟统计模式
运行无头引擎多线程并行推演开牌事件，以此来统计概率出现次数与数学极限：

```bash
# 启动 8 个核心线程执行 1,000,000 局仿真对决
./ez_baccarat --simulate=1000000 --workers=8
```
